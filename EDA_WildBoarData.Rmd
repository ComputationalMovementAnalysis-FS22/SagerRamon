---
title: "EDA - Wild Boar Data"
output: html_document
date: "`r Sys.Date()`"
editor_options: 
  chunk_output_type: inline
---

```{r, warning=F, message=F}
rm(list = ls())
library(ComputationalMovementAnalysisData)
library(tidyverse)

ws <- wildschwein_BE
```

```{r}
names(ws)
n_distinct(ws$TierID)
```
```{r}

ws <- ws %>% 
  group_by(TierID) %>% 
  mutate(timelag = as.integer(difftime(lead(DatetimeUTC), DatetimeUTC, units = "secs"))) %>% 
  ungroup()

summary(ws$timelag)
# 19 NA's because of 19 distinct ID's
```

--------------------------------------------------------------------------------


# Exploring Sampling Intervals


```{r}
ws$TierID <- as.factor(ws$TierID)

p1 <- ws %>% ggplot(aes(x = DatetimeUTC, y = TierID, colour = TierID)) +
  geom_point(show.legend = F)

p1  
```

```{r}
range(ws$timelag, na.rm = T)
nrow(ws)

ws_range <- ws %>% filter(timelag >= 0 & timelag < 30000) 

range(ws_range$timelag, na.rm = T)
nrow(ws_range)

nrow(ws) - nrow(ws_range)
```


```{r}
ws_range %>% 
  ggplot(aes(x = timelag)) +
  geom_histogram(binwidth = 60) +
  scale_y_log10()
```

```{r, fig.height=8}
# p2 <- ws_range %>% ggplot(aes(x = DatetimeUTC, y = TierID, colour = TierID)) +
#   geom_point(show.legend = F)
# p2
# grid.arrange(p1,p2, nrow = 1)
```

```{r}
ws_range2 <- ws %>% filter(timelag >= 0 & timelag < 2000)

ws_range2 %>% 
  ggplot(aes(x = timelag)) +
  geom_histogram(binwidth = 1) +
  scale_y_log10()
```
- most sampling intervals are between 10 & 20 minutes

```{r}
# ws_range3 <- ws %>% filter(timelag >= 0 & timelag < 500)
ws_range3 <- ws %>% filter(timelag >= 50 & timelag < 70)

ws_range3 %>% 
  ggplot(aes(x = timelag)) +
  geom_histogram(binwidth = 1) +
  scale_y_log10()

```
-> around 30000 sampling intervals are within 1 minute
```{r}
ws_range3 <- ws_range3 %>% filter(DatetimeUTC > "2015-01-01" & DatetimeUTC < "2016-01-01")

p3 <- ws_range3 %>% ggplot(aes(x = DatetimeUTC, y = TierID, colour = TierID)) +
  geom_point(show.legend = F)

p3

```
--> Animal ID's c(10, 22, 36, 40, 48) have smapling interval's of one minute in overlapping times in the year 2015




--------------------------------------------------------------------------------


```{r}

```
















