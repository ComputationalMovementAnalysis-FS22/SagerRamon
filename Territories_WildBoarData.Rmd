---
title: "Territories"
output: html_document
date: "`r Sys.Date()`"
---

# Can we identify (core) territories of individual Wild Boar in their resting/sleeping sites and feeding grounds?

We expect that we can at least to some extent identify core territories. Given that, we further expect that these territories differ in size between the resting sites (the forest patch) and the feeding grounds (agricultural sites).


```{r, warning=F, message=F}
rm(list = ls())
```

```{r, warning=F, message=F}
library(ComputationalMovementAnalysisData)
library(tidyverse)
library(sf)
library(tmap)
library(terra)

```

```{r, warning=F, message=F}
ws <- wildschwein_BE
metadata <- wildschwein_metadata
```

```{r}
names(ws)
names(metadata)
n_distinct(ws$TierID)
n_distinct(ws$CollarID)
```
# Data Preparation
```{r}
ws <- merge(ws, metadata[, c("TierID","Sex")], by = "TierID")
ws <- merge(ws, metadata[, c("TierID","Study_area")], by = "TierID")
  
ws_fin <- ws %>% 
  subset(select = - c(CollarID, day, moonilumination)) %>% 
  filter(Study_area == "Bern")
```



# Transforming to SF
```{r}
ws_sf <- st_as_sf(ws_fin,
                coords = c("E", "N"), 
                crs = 2056)
```
```{r}
ws_grp <- ws_sf %>% group_by(TierID)
ws_smry <- summarise(ws_grp)

mcp <- st_convex_hull(ws_smry)

```




# Plotting Convex Hull's
```{r, message=F, warning=F}
pk100_BE <- terra::rast("pk100_BE.tif")
pk100_BE
```

```{r}
tm_shape(pk100_BE) + 
    tm_rgb() +
    tm_shape(mcp) +
    tm_polygons("TierID", alpha = 0.5, border.col = "red")

```


















