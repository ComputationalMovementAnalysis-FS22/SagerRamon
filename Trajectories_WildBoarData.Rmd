---
title: "Trajectories_WildBoarData"
output: html_document
date: "`r Sys.Date()`"
---

```{r, warning=F, message=F}
rm(list = ls())
```


```{r, warning=F, message=F}
library(ComputationalMovementAnalysisData)
library(tidyverse)
library(sf)
```


```{r, warning=F, message=F}
ws <- wildschwein_BE
metadata <- wildschwein_metadata
```


```{r}
ws <- ws %>% 
  group_by(TierID) %>% 
  mutate(timelag = as.integer(difftime(lead(DatetimeUTC), DatetimeUTC, units = "secs"))) %>% 
  ungroup()

summary(ws$timelag)
# 19 NA's because of 19 distinct ID's
```

```{r}

ws$TierID <- as.factor(ws$TierID)

# Filtering and Removing some columns:
ws_range <- ws %>% 
  filter(timelag >= 0 & timelag < 30000) %>% 
  subset(select = - c(day, CollarID, moonilumination))
```


```{r}
# 60 second sampling interval
ws_60s <- ws_range %>% filter(timelag >= 50 & timelag < 70)
```

```{r}
# During the relevant and overlapping time
ws_60s <- ws_60s %>% filter(DatetimeUTC > "2015-01-01" & DatetimeUTC < "2016-01-01")


# Plot with the 5 overlapping individuals
p3 <- ws_60s %>% ggplot(aes(x = DatetimeUTC, y = TierID, colour = TierID)) +
  geom_point(show.legend = F)

p3

```














